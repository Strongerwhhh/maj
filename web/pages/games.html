<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<script type="text/javascript" src="js/jQuery.js"></script>
	<link rel="stylesheet" href="css/games.css" />
	<link rel="shortcut icon" href="#" />
	<link href="favicon.ico" rel="shortcut icon">

	<body background="<%=basePath%>img/background.jpg">
	<!--麻将图-->
	<!--1号位-->
	<div class="tableNum_1">

	</div>
	<!--1号位的出牌区-->
	<div class="tableNum_1_input">

	</div>
	<!--2号位-->
	<div class="tableNum_2">

	</div>
	<!--2号位的出牌区-->
	<div class="tableNum_2_input">

	</div>
	<!--3号位-->
	<div class="tableNum_3">

	</div>
	<!--3号位的出牌区-->
	<div class="tableNum_3_input">

	</div>
	<!--4号位-->
	<div class="tableNum_4">

	</div>
	<!--4号位的出牌区-->
	<div class="tableNum_4_input">

	</div>

	<!-- 吃碰杠区 -->
	<div class="tableNum_1_demo">

	</div>
	<div class="tableNum_2_demo">

	</div>
	<div class="tableNum_3_demo">

	</div>
	<div class="tableNum_4_demo">

	</div>
	<!-- 出牌按钮 -->
	<div>
		<button id="start">开始游戏</button>
	</div>
	</body>
	<script>
		function getImgSrc(majId) {
				return "'<%=basePath%>img/" + (majId % 34 + 1) + ".png'";
			}
		
			//初始化手牌		  
		function initMaj(tableNum, majIdList) {
				var num = "";
				console.log(majIdList);
				arr.sort(majIdList);
				for (var i = 0; i < majIdList.size(); i++) {
					num += "<div class='" + tableNum + "_majiang'><img src=" + getImgSrc(majIdList[i]) + " class='" + tableNum + "_img'></div>";
				}
				$("." + tableNum).html(num);
				console.log(num);
			}
		
			//刷新出牌区
		function refreshInput(tableNum, tableMaj) {
				var input_num = ""; //出牌区的牌
				//遍历tableMaj，讲图片加入到tablenum_i_input中
				for (var i = 0; i < tableMaj.size(); i++) {
					input_num += "<div class='" + tableNum + "_majiang'><img src='" + (tableMaj.get(i) % 34 + 1) + ".png' class='" + tableNum + "_img'></div>";
				}
				$("." + tableNum + "_input").html(input_num);
			}
		
			//吃碰杠区的刷新
		function pengArea(tableNum, majId) {
				var refreshPeng = "";
				for (var i = 0; i < 3; i++) {
					refreshPeng += "<div><img src=" + getImgSrc(majId) + " class='" + tableNum + "_img'</div>";
				}
				$("." + tableNum + "_demo").html(refreshPeng);
			}
		
			//其他人的牌，背面表示
		function otherMaj(tableNum, majIdList) {
				var otherMaj = "";
				//还要传其他3个人的tableNum
				for (var i = 0; i < majIdList.size(); i++) {
					otherMaj += "<div class='" + tableNum + "_majiang'><img src='img/35.png' class='" + tableNum + "_img'></div>";
				}
				$("." + tableNum).html(otherMaj);
			}
		
			//每回合的抽牌
		function getMaj(tableNum, majId) {
				var innerHTML = $("." + tableNum).innerHTML;
				var newMaj = "<div class='" + tableNum + "_majiang' ><img src=" + getImgSrc(majId) + " class='" + tableNum + "_img'></div>";
				$("." + tableNum).html(innerHTML + newMaj);
			}
		
			//出牌	
		function outputMaj(tableNum, majId, majIdList, tableMaj) {
				var refreshList = "";
				$("." + tableNum).on('click', '.' + tableNum + '_majiang', function() {
					//先判断点击的是哪张牌
					var majSeq = parseInt($("." + tableNum).index(this));
					//移除tablenum_i中的这张牌
					$("." + tableNum).eq(majSeq).remove();
					//加入到tableMaj中
					tableMaj.add(majId);
					//刷新出牌区
					refreshInput(tableNum, tableMaj);
					//重新排序你的手牌
					initMaj(tableNum, majIdList);
				})
			}
		
			//碰
			//其他三个人遍历自己的手牌，看有没有和对应的牌相同的，并且有两张；
		function touch(tableNum, majId, majIdList, tableMaj) {
			var demo = "";
			var j = "";
			for (var i = 0; i < majIdList.size(); i++) {
				if ((majIdlist.get(i) % 34 + 1) == (majId % 34 + 1) && (majIdlist.get(i + 1) % 34 + 1) == (majId % 34 + 1)) {
					demo = "<img src='img/碰.png' class='majdemo_" + tableNum + "_peng'></img>";
					$("." + tableNum + "_input").html(demo);
					//碰的点击事件,让碰图标消失，把出的牌和自己手牌里的两张牌，放到吃碰杠区
					$(".majdemo_" + tableNum + "_peng").click(function() {
						$(".majdemo_" + tableNum + "_peng").remove(); //删除碰的图标		   											
						j = i;
					})
				}
			}
			//删除tableMaj最后个值和majIdList中与其相同的两个值
			majIdList.remove(j);
			majIdList.remove(j + 1);
			tableMaj.remove(tableMaj.size() - 1);
			//重新刷新手牌区,出牌区和吃碰杠区
			refreshInput(tableNum, tableMaj);
			initMaj(tableNum, majIdList);
			pengArea(tableNum, majId);
		}
	</script>
</html>